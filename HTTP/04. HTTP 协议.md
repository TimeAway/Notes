## 简单的 HTTP 协议

**HTTP** 协议用于客户端和服务器端之间的通信。

请求访问文本或图像等资源的一端称为客户端，而提供资源响应的一端称为服务器端。HTTP 协议规定，请求从客户端发出，最后服务器端响应该请求并返回。

![http 协议](./images/http.jpeg)

### 1. HTTP 无状态

HTTP 是一种不保存状态，即无状态（stateless）协议。HTTP协议自身不对请求和响应之间的通信状态进行保存。也就是说在HTTP这个级别，协议对于发送过的请求或响应都不做持久化处理。

无状态协议更快地处理大量事务，确保协议的可伸缩性，而特意把HTTP协议设计成如此简单的。

有些场景下需要记住状态，此时可以使用 [Cookie 状态管理](./Cookie 状态管理.md)。

### 2. HTTP 持久化

HTTP 协议的初始版本中，每进行一次HTTP通信就要断开一次TCP连接。

用浏览器浏览一个包含多张图片的HTML页面时，在发送请求访问HTML页面资源的同时，也会请求该HTML页面里包含的其他资源。因此，每次的请求都会造成无谓的TCP连接建立和断开，增加通信量的开销。

为了解决 TPC 链接的问题，即出现了持久连接（HTTP PersistentConnections，也称为HTTP keep-alive或HTTP connection reuse）的方法。

持久连接的特点是，只要任意一端没有明确提出断开连接，则保持TCP连接状态。

持久连接的好处在于减少了TCP连接的重复建立和断开所造成的额外开销，减轻了服务器端的负载。另外，减少开销的那部分时间，使HTTP请求和响应能够更早地结束，这样Web页面的显示速度也就相应提高了。

### 3. HTTP 管线化

从前发送请求后需等待并收到响应，才能发送下一个请求。管线化技术出现后，不用等待响应亦可直接发送下一个请求。

这样就能够做到同时并行发送多个请求，而不需要一个接一个地等待响应了。

比如，当请求一个包含10张图片的HTML Web页面，与挨个连接相比，用持久连接可以让请求更快结束。而管线化技术则比持久连接还要快。请求数越多，时间差就越明显。

![pipelining](./images/pipelining.jpeg)

### 4. HTTP 协议的缺点

- 通信使用明文（不加密），内容可能会被窃听

- 不验证通信方的身份，因此有可能遭遇伪装
- 无法证明报文的完整性，所以有可能已遭篡改

